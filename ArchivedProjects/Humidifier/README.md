# IoT-Humidifier

A humidifier controlled by ESP8266.

ESP8266控制的加湿器。

## 时间线

- 2017.11.26 灵机一动提出改造设想。
- 2017.11.27 拆解机器本体，分析系统结构。搜索加湿器的原理和经典设计，尤其是振荡电路部分。了解到加湿器方案大致分为自激式和他激式两类，并且通过分析机器结构，得知机器采用自激式振荡电路。
- 2017.11.28 阅读原有主控芯片的Datasheet，希望通过原有主控间接控制机器本体。但是因为触摸按键并不好Hack，所以放弃了间接控制的想法。并测量各接口和端点的电压，分析接口功能和协议特点。
- 2017.11.29 初步完成ESP8266服务器程序框架。
- 2017.11.30 设计ESP8266与机器本体之间的接口电路。风机控制采用继电器，雾化功率直接输出3.3V电压的1kHz脉宽信号。搭建测试电路并运行成功。
- 2017.12.1 加工、焊接与原有主控板尺寸相同的新接口板。风机控制改用FET。系统不带彩灯试运行，实现了基本的HTTP控制功能。
- 2017.12.2 设计了比较美观的前端页面。
- 2017.12.3 购买的PCF8574T到货，使用其扩展出三个低电平驱动的LED端口，并将其安装在原有的接口板上。将USB线从机壳中引出，装回并试运行。

**以下是计划**

- 2017.12.4 设计标准的接口集合，以及网关的设计。接口需要有通用性。参照米家的设计。
- 2017.12.5 考虑将PCF8563时钟芯片集成进机器，实现定时开关机。这一功能需要评估，因为该功能（“自动化”）完全可以通过网关实现。

## 项目概述

改造小熊品牌的一款家用小型加湿器。该加湿器具有湿度检测和自动恒湿的功能。

加湿器采用佛山汉毅提供的全套加湿器方案。雾化器为自激式，驱动电路为模块化设计，目测支持自动追频/功率调节。

控制板不负责追频。MCU采用台湾凌通的GPM8F3708B-HS101单片机，通过输出100Hz三档占空比的PWM信号，控制驱动电路输出不同的雾化功率。

本次改造的目的是使用NodeMCU替换掉原有的单片机。
